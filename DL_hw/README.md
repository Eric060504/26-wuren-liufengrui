# 锥桶颜色分类模型

## 项目概述

本项目使用基于ResNet思想的卷积神经网络对锥桶颜色（红色、蓝色、黄色）进行分类。模型设计遵循层数限制，同时通过残差连接提升性能，能够对两个测试集进行验证并输出详细的准确率报告。

## 代码流程和细节

### 1. 数据处理
 **数据集结构**：程序适配以下文件夹结构
  ```
  dataset/
  ├── train/
  │   ├── red/
  │   ├── blue/
  │   └── yellow/
  ├── test1/
  │   ├── red/
  │   ├── blue/
  │   └── yellow/
  └── test2/
      ├── red/
      ├── blue/
      └── yellow/
  ```
 **数据增强**：为提高模型泛化能力，对训练数据应用了多种增强技术：
 随机裁剪（带填充）
 随机水平翻转
 随机旋转（±15度）
 颜色抖动（亮度、对比度、饱和度和色调）
 **数据预处理**：
 所有图像调整为64x64尺寸
 转换为Tensor格式
 使用ImageNet数据集的均值和标准差进行标准化

### 2. 模型训练
 **优化器**：使用Adam优化器，初始学习率0.001 **学习率调整**：采用ReduceLROnPlateau策略，当验证损失不再下降时将学习率减半 **正则化**：使用L2正则化（weight_decay=14）防止过拟合 **训练轮数**：默认30个epochs，可根据需要调整 **模型保存**：自动保存在test1上表现最好的模型

### 3. 模型验证
 在两个测试集（test1和test2）上进行验证 计算并输出整体准确率 计算并输出每个类别的准确率 生成训练过程中的损失和准确率曲线

## 网络模型设计

模型基于ResNet的残差连接思想，具体结构如下：

1. **初始卷积层**：
 3x3卷积核，输入3通道（RGB），输出16通道
 输入尺寸：3x64x64，输出尺寸：16x64x64

2. **残差块组**：
 第一组：2个残差块，16通道，输出尺寸：16x64x64
 第二组：2个残差块，32通道，输出尺寸：32x32x32（通过stride=2下采样）
 第三组：2个残差块，64通道，输出尺寸：64x16x16（通过stride=2下采样）

3. **全局平均池化**：
 将64x16x16的特征图转换为64维向量

4. **全连接层**：
 第一层：64 → 32
 第二层：32 → 3（对应三个颜色类别）

**层数统计**：总卷积层7层，全连接层2层。

## 创新点

1. **改进的残差块设计**：在有限层数内实现了残差连接，有效缓解深层网络的梯度消失问题

2. **针对性数据增强**：根据锥桶颜色分类任务特点，使用颜色抖动增强来提高模型对颜色变化的鲁棒性

3. **动态学习率调整**：根据验证损失自动调整学习率，平衡模型收敛速度和精度

4. **轻量级网络结构**：在严格的层数限制下，通过合理的通道数和尺寸设计，实现了高效特征提取

## 输出结果

 训练过程中的损失和准确率会实时打印
 最佳模型会保存为`best_model.pth`
 训练曲线会保存为`training_curves.png`
 最终会输出test1和test2的整体准确率和每类准确率

## 注意事项
 确保数据集路径正确，程序默认读取当前目录下的`dataset`文件夹 如果训练数据量较小，可适当增加数据增强强度或减少训练轮数防止过拟合 如无GPU，程序会自动使用CPU运行，但训练速度会较慢 可根据实际情况调整batch_size、学习率等超参数以获得更好的性能
