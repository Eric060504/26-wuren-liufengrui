# Simulink 中纯追踪 + PID 控制模型学习笔记

## 一、核心问题与解决思路

### （一）Scope 无动态画面的根源

在纯追踪（Pure Pursuit）与 PID 控制的 Simulink 模型中，Scope 显示静态画面，本质是 **信号动态特性不足** 或 **显示配置未适配**。需从控制算法逻辑、信号连接、Scope 配置三方面协同排查：


1.  **控制算法保守**：PID 参数（如 `Kp` 过小、`Kd` 过大）或纯追踪参数（如预瞄距离 `L` 过大）使系统过度稳定，无震荡超调。

2.  **信号维度不匹配**：前期因参考路径数组（`[1x200]`）与标量控制逻辑冲突，导致信号传递异常，动态特性被抑制。

3.  **Scope 配置缺失**：未开启 “滚动更新”“实时刷新”，或时间轴范围设置不合理，压缩动态细节。

## 二、关键模块调试与配置

### （一）纯追踪算法（Pure_Pursuit）



1.  **核心逻辑**：通过预瞄距离 `L` 匹配当前参考点，计算车辆坐标系下横向距离 `dy_veh`，最终输出转向角 `delta`。

2.  **参数敏感点**：

*   预瞄距离 `L = max(2 + 0.5*v, 3)`：`L` 过小会导致转向频繁震荡，过大则响应迟钝。可通过 `L = max(2 + 0.5*v, 1.5)` 减小下限，增强动态响应。

*   转向角限幅 `delta = max(min(delta, 0.52), -0.52)`：限幅过严会压制震荡，需根据实际需求调整（如放宽至 `±0.8 rad` 观察动态）。

### （二）PID 速度控制（Manual_PID）



1.  **核心逻辑**：通过 `Kp`（比例）、`Ki`（积分）、`Kd`（微分）协同调节加速度 `a`，跟踪参考速度 `v_ref`。

2.  **参数调试技巧**：

*   `Kp = 0.8 → 2.0`：增大 `Kp` 可引入速度超调（震荡），快速验证动态特性。

*   `Kd = 0.03 → 0.01`：减小微分作用，避免过度抑制震荡。

### （三）Scope 动态显示配置



1.  **实时更新开启**：

*   双击 Scope → 齿轮图标（配置）→ **“时间” 选项卡** → “时间跨度超限操作” 设为 **“滚动”**，确保仿真超限时画面持续更新。

*   仿真运行时，右键 Scope → **“Format → Style → Animation”**，强制开启动态显示（静止时隐藏该选项，运行时激活）。

1.  **时间轴优化**：

*   仿真前设置 “停止时间”（如 `50` 秒）延长运行时长，或通过 “步进仿真”（逐帧运行）精细观察动态。

## 三、模型简化与验证流程

### （一）极简模型搭建（5 模块核心链路）



1.  **参考信号**：`ref_signal` 输出标量当前点（`x_ref_single, y_ref_single`）与参考速度 `v_ref`，替代原数组输出，避免维度冲突。

2.  **控制算法**：`Pure_Pursuit`（标量输入输出）+ `Manual_PID`（标量输入输出），直接驱动简化车辆模型（传递函数近似）。

3.  **可视化**：`Scope` 仅显示关键信号（横向误差、速度偏差、转向角、加速度），`XY Graph` 展示路径贴合效果。

### （二）验证标准与调试步骤



1.  **信号维度验证**：

*   右键信号连线 → **Properties** → 确认 `Pure_Pursuit` 输入输出为标量（`[1x1]`），`PID` 信号为标量。

1.  **动态特性验证**：

*   增大 `Kp`（如 `2.0`），观察 `Scope` 中速度偏差是否出现超调震荡；

*   减小预瞄距离下限（如 `1.5`），观察转向角 `delta` 是否波动。

1.  **最终收敛验证**：

*   横向误差稳定在 `±0.3 m` 内，速度偏差稳定在 `±0.5 m/s` 内，判定系统收敛。

## 四、经验总结与避坑指南



1.  **信号维度拆分**：区分 “实时控制信号（标量）” 与 “可视化信号（数组）”，避免 `Mux/Demux` 维度冲突，从源头解决动态显示异常。

2.  **参数调试节奏**：先调 PID 引发超调（验证动态），再调纯追踪优化路径贴合，最后限幅稳定系统，分阶段调试更高效。

3.  **Scope 配置优先级**：优先设置 “时间跨度超限操作 = 滚动”+“仿真期间更新”，确保动态画面不丢失；再通过参数调整让信号产生震荡，而非依赖 Scope 强制显示。